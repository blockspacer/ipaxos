syntax = "proto3";
import "google/protobuf/wrappers.proto";
package ipaxos;

service Paxos
{
  rpc commit (PaxosMsg) returns (PaxosMsg) {}
  rpc learn (PaxosMsg) returns (PaxosMsg) {}
  rpc propose (ProposeRequest) returns (ProposeResult) {}
}

message ProposeRequest
{
  bytes value = 1;
}

message ProposeResult
{
  bool success = 1;
}

message PaxosMsg
{
  uint64 node_id = 1;
  uint64 epoch = 2;
  uint64 instance_id = 3;
  uint64 last_commit_id = 4;
  google.protobuf.BytesValue value = 5;
  enum Result {
    SUCCESS = 0;
    CONFLICT = 1; // hint the value already learned
    FOLLOWUP = 2; // hint to follow up
  }
  Result result = 6;
}
